# Authorisation Model

Cafe Variome uses a mixed, but mainly local authorisation model to handle user permission. In short, each user or node would need to be approved locally.

## User account and encryption key

For a user to log into a CV3 instance, they would need to have an account in the system. This account is created in OIDC provider, and should have a local database entry. Meanwhile, for a user to query data, they would need to have an encryption key, which is generated by the system and stored in the vault. The encryption key is used to encrypt/decrypt the query data.

Here is a table of user types, their account conditions and permissions to perform queries:

| User Type         | OIDC account | Local DB account | Encryption key |   permission    |
|-------------------|:------------:|:----------------:|:--------------:|:---------------:|
| Anonymous         |      No      |        No        |       No       |      None*      |
| Remote user       |     Yes      |        No        |       No       |     None**      |
| Remote query user |     Yes      |       Yes        |       No       |      Query      |
| Local user        |     Yes      |       Yes        |      Yes       | Login and query |

- *: Anonymous users, by default, cannot query the system. However, admins can selectively allow anonymous querying. If the option is turned on, anonymous user would have access to all metadata, and the record level sources that have been assigned to the `anonymous` internal user.
- **: Remote users have no local database entry, and their queries will be rejected. However, admins may choose to turn on automatic registration, which will assign a local database entry to a user who has an OIDC account, but no local database entry. This would turn the user into a remote query user. Refer to [](user-and-admin-access-control.md#automatic-user-registration) for more details.

## Discovery group

<include from="user-and-admin-access-control.md" element-id="discovery-group-access-control" />

<seealso>
    <category ref="related">
        <a href="authorisation.md"/>
        <a href="user-and-admin-access-control.md"/>
        <a href="federated-authorisation.md"/>
    </category>
</seealso>
